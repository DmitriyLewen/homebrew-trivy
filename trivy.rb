# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Trivy < Formula
  desc "Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
  homepage "https://github.com/aquasecurity/trivy"
  version "0.29.9"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/DmitriyLewen/trivy/releases/download/v0.29.9/trivy_0.29.9_macOS-64bit.tar.gz"
      sha256 "a641be72920cb2a8c17798423d4684f36f8cd7077332093eb889265c2025ab81"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/DmitriyLewen/trivy/releases/download/v0.29.9/trivy_0.29.9_macOS-ARM64.tar.gz"
      sha256 "15b7a21367cb2446d936a14452ff48a52481fc1adf632b7f182d91b9ccdc43b0"

      def install
        bin.install "trivy"
      end
    end
  end

  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/DmitriyLewen/trivy/releases/download/v0.29.9/trivy_0.29.9_Linux-ARM64.tar.gz"
      sha256 "5d1bf23b583ea76d79396e996ca719b69bd348b9ec4304435fc449c6c2ce978a"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/DmitriyLewen/trivy/releases/download/v0.29.9/trivy_0.29.9_Linux-64bit.tar.gz"
      sha256 "7aefa3bc3cd35f14d209119386c869bae457619be95ca5c3677546c89895d492"

      def install
        bin.install "trivy"
      end
    end
  end

  test do
    system "#{bin}/trivy", "--version"
  end
end
