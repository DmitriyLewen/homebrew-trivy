# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Trivy < Formula
  desc "Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
  homepage "https://github.com/aquasecurity/trivy"
  version "0.25.4"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.25.4/trivy_0.25.4_macOS-64bit.tar.gz"
      sha256 "dc0639dc3c82a664249c8cb100db738f1c46ac4e423448f431534b9a19481ca2"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.25.4/trivy_0.25.4_macOS-ARM64.tar.gz"
      sha256 "73a4f992bee5c71b98e3c376b2e951029ab88ed15687e4b802c385df98ddd670"

      def install
        bin.install "trivy"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.25.4/trivy_0.25.4_Linux-64bit.tar.gz"
      sha256 "163ac63ee2dc89459b8ddf94880a408de95b087031ccd0533ebde5a631ab20f5"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.25.4/trivy_0.25.4_Linux-ARM64.tar.gz"
      sha256 "a299627305174da677e322ef519835d37aefaca11cae101beccc781b63c2ec91"

      def install
        bin.install "trivy"
      end
    end
  end

  test do
    system "#{bin}/trivy", "--version"
  end
end
